<!-- DataTable with header -->
<app-datatable 
    [columns]="menusColumns" 
    [data]="menus" 
    [actions]="menusActions" 
    [headerConfig]="headerConfig"
    (btnClickTrigger)="openAddMenuModal()" 
    [config]="{
        pageSize: 5,
        showSearch: true,
        showPagination: true
        }">
</app-datatable>

<!-- Add Menu Modal -->
<app-modal [isOpen]="isAddModalOpen" (close)="closeAddMenuModal()" [title]="'Add Menu'" className="max-w-md" [size]="550">
    <div class="p-6">
        <!-- Modal Heading -->
        <h2 class="mb-4 text-xl font-semibold text-gray-800 dark:text-white/90">
            Add Menu
        </h2>

        <!-- Name Field -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Name
            </label>
            <input type="text" [(ngModel)]="formName" placeholder="Enter menu name" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm text-gray-800 shadow-theme-xs
               placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:placeholder:text-white/30 dark:focus:border-brand-800" />
        </div>

        <!-- Path Field -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Path
            </label>
            <input type="text" [(ngModel)]="formPath" placeholder="Enter menu path (e.g., /dashboard)" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm text-gray-800 shadow-theme-xs
               placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:placeholder:text-white/30 dark:focus:border-brand-800" />
        </div>

        <!-- Icon Field with Preview -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Icon
            </label>
            <div class="flex gap-3 items-center">
                <input type="text" [(ngModel)]="formIcon" placeholder="Enter icon name (e.g., fas fas-user)" class="flex-1 rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm text-gray-800 shadow-theme-xs
                 placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden
                 focus:ring-3 focus:ring-brand-500/10
                 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
                 dark:placeholder:text-white/30 dark:focus:border-brand-800" />
                <!-- Icon Preview -->
                @if (formIcon.trim()) {
                <div
                    class="flex items-center justify-center w-12 h-10 rounded-lg border border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-gray-800">
                    <i [class]="formIcon" class="text-xl text-gray-700 dark:text-gray-300"></i>
                </div>
                }
            </div>
        </div>

        <!-- Menu Group Dropdown -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Menu Group
            </label>
            <select [(ngModel)]="formMenuGroupId" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm text-gray-800 shadow-theme-xs
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:focus:border-brand-800">
                <option [value]="null">Select Menu Group</option>
                @for (group of menuGroups; track group.id) {
                    <option [value]="group.id">{{ group.name }}</option>
                }
            </select>
        </div>

        <!-- Role Multi-Select -->
        <div class="mb-4">
            <app-multi-select
                [label]="'Roles'"
                [options]="roleOptions"
                [defaultSelected]="formRoleIds"
                (selectionChange)="formRoleIds = $event">
            </app-multi-select>
        </div>

        <!-- Status Field -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Status
            </label>
            <select [(ngModel)]="formStatus" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm text-gray-800 shadow-theme-xs
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:focus:border-brand-800">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
            </select>
        </div>

        <!-- Footer Buttons -->
        <div class="flex justify-end gap-3">
            <app-button [variant]="'outline'" [size]="'md'" (btnClick)="closeAddMenuModal()">
                Cancel
            </app-button>

            <app-button [variant]="'primary'" [size]="'md'" [disabled]="isAddButtonDisabled()" (btnClick)="addMenu()">
                <i class="fas fa-plus mr-2"></i>
                Add Menu
            </app-button>
        </div>
    </div>
</app-modal>


<!-- Edit Menu Modal -->
<app-modal [isOpen]="isEditModalOpen" (close)="closeEditMenuModal()" [title]="'Edit Menu'" className="max-w-md">
    <div class="p-6">
        <!-- Modal Heading -->
        <h2 class="mb-4 text-xl font-semibold text-gray-800 dark:text-white/90">
            Edit Menu
        </h2>

        <!-- Name Field -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Name
            </label>
            <input type="text" [(ngModel)]="formName" placeholder="Enter menu name" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm
               text-gray-800 shadow-theme-xs placeholder:text-gray-400
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:placeholder:text-white/30 dark:focus:border-brand-800" />
        </div>

        <!-- Path Field -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Path
            </label>
            <input type="text" [(ngModel)]="formPath" placeholder="Enter menu path (e.g., /dashboard)" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm
               text-gray-800 shadow-theme-xs placeholder:text-gray-400
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:placeholder:text-white/30 dark:focus:border-brand-800" />
        </div>

        <!-- Icon Field with Preview -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Icon
            </label>
            <div class="flex items-center gap-3">
                <input type="text" [(ngModel)]="formIcon" placeholder="Enter icon class (e.g., fas fa-user)" class="flex-1 rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm
                 text-gray-800 shadow-theme-xs placeholder:text-gray-400
                 focus:border-brand-300 focus:outline-hidden
                 focus:ring-3 focus:ring-brand-500/10
                 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
                 dark:placeholder:text-white/30 dark:focus:border-brand-800" />

                <!-- Icon Preview -->
                @if (formIcon?.trim()) {
                <div class="flex items-center justify-center w-12 h-11 rounded-lg border
                   border-gray-300 bg-gray-50 shadow-theme-xs
                   dark:border-gray-700 dark:bg-gray-800">
                    <i [class]="formIcon" class="text-lg text-gray-700 dark:text-gray-300"></i>
                </div>
                }
            </div>
        </div>

        <!-- Menu Group Dropdown -->
        <div class="mb-4">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Menu Group
            </label>
            <select [(ngModel)]="formMenuGroupId" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm
               text-gray-800 shadow-theme-xs
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:focus:border-brand-800">
                <option [value]="null">Select Menu Group</option>
                @for (group of menuGroups; track group.id) {
                    <option [value]="group.id">{{ group.name }}</option>
                }
            </select>
        </div>

        <!-- Roles Multi-Select -->
        <div class="mb-6">
            <app-multi-select 
                [label]="'Roles'" 
                [options]="roleOptions" 
                [defaultSelected]="formRoleIds" 
                (selectionChange)="formRoleIds = $event">
            </app-multi-select>
        </div>

        <!-- Status Field -->
        <div class="mb-6">
            <label class="block mb-2 text-sm font-medium text-gray-700 dark:text-gray-400">
                Status
            </label>
            <select [(ngModel)]="formStatus" class="w-full rounded-lg border border-gray-300 bg-transparent py-2.5 px-4 text-sm
               text-gray-800 shadow-theme-xs
               focus:border-brand-300 focus:outline-hidden
               focus:ring-3 focus:ring-brand-500/10
               dark:border-gray-700 dark:bg-gray-900 dark:text-white/90
               dark:focus:border-brand-800">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
            </select>
        </div>

        <!-- Footer Buttons -->
        <div class="flex justify-end gap-3">
            <app-button [variant]="'outline'" [size]="'md'" (btnClick)="closeEditModal()">
                Cancel
            </app-button>

            <app-button [variant]="'primary'" [size]="'md'" [disabled]="isEditButtonDisabled()"
                (btnClick)="updateMenu()">
                <i class="fas fa-save mr-2"></i>
                Save
            </app-button>
        </div>
    </div>
</app-modal>

<!-- Delete Confirmation Modal -->
<app-modal 
  [isOpen]="isDeleteModalOpen"
  (close)="closeDeleteModal()"
  [title]="'Delete Menu'"
  className="max-w-md"
>
  <div class="p-6">
    <!-- Modal Heading -->
    <h2 class="mb-4 text-xl font-semibold text-gray-800 dark:text-white/90">
      Delete Menu
    </h2>

    <!-- Confirmation Text -->
    <div class="mb-6 text-sm text-gray-700 dark:text-gray-300">
      <p>
        Are you sure you want to delete
        <span class="font-semibold text-gray-900 dark:text-white">
          {{ deletingMenu?.name }}
        </span>?
      </p>
      <!-- <p class="mt-2 text-xs text-red-600 dark:text-red-400">
        This action cannot be undone.
      </p> -->
    </div>

    <!-- Footer Buttons -->
    <div class="flex justify-end gap-3">
      <app-button
        [variant]="'outline'"
        [size]="'md'"
        (btnClick)="closeDeleteModal()"
      >
        Cancel
      </app-button>

      <app-button
        [variant]="'primary'"
        [size]="'md'"
        (btnClick)="confirmDelete()"
        class="bg-red-500 hover:bg-red-600 focus:ring-red-500/20"
      >
        <i class="fas fa-trash mr-2"></i>
        Yes, Delete
      </app-button>
    </div>
  </div>
</app-modal>